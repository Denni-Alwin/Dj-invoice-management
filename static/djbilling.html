<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dj Invoice management</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.13/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="h-screen flex flex-row">

    <!-- Sidebar -->
    <aside class="w-64 h-[1500px] bg-base-200 shadow-lg flex-shrink-0">
        <div class="p-5">
            <h2 class="text-2xl font-bold text-primary">Dj Computer</h2>
            <ul class="menu p-4 space-y-6" style="margin-top: 30px;">
                <li><a href="#" class="menu-item hover:bg-primary hover:text-white" onclick="showContent('home'); getAmountToBeCollected(); getAllInvoices(); fetchTotalAmount(); fetchPendingStatus(); fetchPendingInvoiceCount(); fetchPaidInvoiceCount();">Dashboard</a></li>
                <li><a href="#" class="menu-item hover:bg-primary hover:text-white" onclick="showContent('about'); clearValuesOnSearch()">Contacts</a></li>
                <li><a href="#" class="menu-item hover:bg-primary hover:text-white" onclick="showContent('services'); getAllInvoices()">Invoice</a></li>
                <li><a href="#" class="menu-item hover:bg-primary hover:text-white" onclick="showContent('invoice'); clearValuesOnSearch()">Update Invoice</a></li>
                <li><a href="#" class="menu-item hover:bg-primary hover:text-white" onclick="showContent('invoice-maker'); clearValuesOnSearch()">Make Invoice Bill</a></li>
            </ul>
        </div>
    </aside>
    <!-- Main Content Area -->
    <div class="flex-1 flex flex-col justify-between bg-base-100">
                  <div class="relative">
                    <label class="swap swap-rotate absolute right-20 top-12">
                      <!-- this hidden checkbox controls the state -->
                      <input type="checkbox" class="theme-controller" value="synthwave" />
                    
                      <!-- sun icon -->
                      <svg
                        class="swap-off h-10 w-10 fill-current"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24">
                        <path
                          d="M5.64,17l-.71.71a1,1,0,0,0,0,1.41,1,1,0,0,0,1.41,0l.71-.71A1,1,0,0,0,5.64,17ZM5,12a1,1,0,0,0-1-1H3a1,1,0,0,0,0,2H4A1,1,0,0,0,5,12Zm7-7a1,1,0,0,0,1-1V3a1,1,0,0,0-2,0V4A1,1,0,0,0,12,5ZM5.64,7.05a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.41l-.71-.71A1,1,0,0,0,4.93,6.34Zm12,.29a1,1,0,0,0,.7-.29l.71-.71a1,1,0,1,0-1.41-1.41L17,5.64a1,1,0,0,0,0,1.41A1,1,0,0,0,17.66,7.34ZM21,11H20a1,1,0,0,0,0,2h1a1,1,0,0,0,0-2Zm-9,8a1,1,0,0,0-1,1v1a1,1,0,0,0,2,0V20A1,1,0,0,0,12,19ZM18.36,17A1,1,0,0,0,17,18.36l.71.71a1,1,0,0,0,1.41,0,1,1,0,0,0,0-1.41ZM12,6.5A5.5,5.5,0,1,0,17.5,12,5.51,5.51,0,0,0,12,6.5Zm0,9A3.5,3.5,0,1,1,15.5,12,3.5,3.5,0,0,1,12,15.5Z" />
                      </svg>
                    
                      <!-- moon icon -->
                      <svg
                        class="swap-on h-10 w-10 fill-current"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24">
                        <path
                          d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" />
                      </svg>
                    </label>
                  </div>

                  <main class="p-10 flex-grow">
                    <section id="home" class="content-section">
                        <h1 class="text-2xl font-bold">Dashboard</h1>
                            <div class="cards inline-flex space-x-20 ml-40">  
                                <div class="card bg-base-300 rounded-box grid h-32 w-72 mt-6 flex-grow place-items-center">
                                        <div class="stat">
                                        <div class="stat-title">Total Rotation</div>
                                        <div class="stat-value text-green-500" id="total-amount">0</div>
                                        </div>
                                </div>
                                <div class="card bg-base-300 rounded-box grid h-32 w-72 mt-6 flex-grow place-items-center">
                                  <div class="stat">
                                  <div class="stat-title">Amount Collection</div>
                                  <div class="stat-value text-red-500" id="total-amount-collection">0</div>
                                  </div>
                                </div>
                                <div class="card bg-base-300 rounded-box grid h-32 w-72 mt-6 flex-grow place-items-center">
                                    <div class="stat">
                                    <div class="stat-title">Pending Invoice</div>
                                    <div class="stat-value text-orange-600" id="pending-invoice-count">0</div>
                                    </div>
                                </div>
                                <div class="card bg-base-300 rounded-box grid h-32 w-72 mt-6 flex-grow place-items-center">
                                    <div class="stat">
                                    <div class="stat-title">Paid Invoice</div>
                                    <div class="stat-value text-accent" id="paid-invoice-count">0</div>
                                    </div>
                                </div>
                            </div>
                        <div>

                          <div class="btn-invoice mt-[20px] mb-5">
                            <button class="btn btn-outline btn-success" onclick="my_modal_3.showModal()">Create Invoice</button>
                              <dialog id="my_modal_3" class="modal">
                                <div class="modal-box w-11/12 max-w-4xl">
                                  <form method="dialog">
                                    <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
                                  </form>
                                  <h3 class="text-lg font-bold mb-9">Create Invoice</h3>
                                  <div class="text relative top-9 mr-10">Client Name</div>
                                  <input type="text" id="client_name" class="input input-bordered w-full max-w-xs ml-20 mb-6 relative left-20"/>
                                  <div class="text relative top-9 mr-10">Contact</div>
                                  <input type="text" id="contact" class="input input-bordered w-full max-w-xs ml-20 mb-6 relative left-20"/>
                                  <div class="text relative top-9 mr-10">Type of product</div>
                                    <select id="product_type" class="select select-bordered w-full max-w-xs ml-20 mb-6 relative left-20">
                                      <option>Laptop</option>
                                      <option>Monitor</option>
                                      <option>Printer</option>
                                      <option>Mobile</option>
                                      <option>TV</option>
                                      <option>Inverter</option>
                                    </select>

                                  <div class="text relative top-9 mr-10">Product Description</div>
                                  <input type="text" id="product_description" class="input input-bordered w-full max-w-xs ml-20 mb-6 relative left-20"/>
                                  <div class="text relative top-9 mr-10">Damage/Problem</div>
                                  <input type="text" id="damage_problem" class="input input-bordered w-full max-w-xs ml-20 mb-6 relative left-20"/>
                                  <div class="text relative top-9 mr-10">Address</div>
                                  <input type="text" id="address" class="input input-bordered w-full max-w-xs ml-20 mb-6 relative left-20"/>
                                  <div class="text relative top-9 mr-10">Estimated Amount</div>
                                  <input type="text" id="amount" class="input input-bordered w-full max-w-xs ml-20 mb-6 relative left-20"/>
                                  <button onclick="addInvoice()" class="btn btn-outline btn-success relative top-20 mb-20 p-4 left-40">Add</button>
                                  <div class="result" id="addResult"></div>
                                </div>   
                              </dialog>
                          </div>

                          <div class="overflow-y-auto" style="width: 1700px; height: 400px;">
                                <table class="table mt-2">
                                  <!-- head -->
                                  <thead>
                                    <tr>
                                      <th>Name</th>
                                      <th>Description</th>
                                      <th>Type of Product</th>
                                      <th>Job Status</th>
                                      <th>Payment Status</th>
                                      <th>Given Amount</th>
                                      <th></th>
                                    </tr>
                                  </thead>
                                  <tbody id="data-table-body">
                                </table>
                            </div>      
            </section>

            <section id="about" class="content-section hidden">
                <h1 class="text-4xl font-bold">Get Contact of Client</h1>
                 <div class="flex flex-row gap-5 ml-20 relative">
                  <p class="text-1xl font-bold top-[50px] relative">Search Client Name / InvoiceId</p>
                  <input id="search-invoice-search" type="text" class="input input-bordered input-accent w-full max-w-xs relative top-10"/>
                  <button class="btn btn-outline btn-success relative top-[38px]" onclick="fetchInvoiceDetails()">Search</button>
                  <button class="btn btn-outline btn-error relative top-[38px]" onclick="clearValuesOnSearch()">Clear</button>
                </div>
                <div class="divider mt-24">Client Contact Details</div>
                <div id="client-contact-details" class="hidden">
                  <div class="flex gap-60 mt-[50px] ml-">
                    <div class="stats shadow relative h-[50px] w-[300px] left-[100px] h-auto">
                      <div class="stat flex gap-8">
                        <svg class="" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5.52 19c.64-2.2 1.84-3 3.22-3h6.52c1.38 0 2.58.8 3.22 3"/><circle cx="12" cy="10" r="3"/><circle cx="12" cy="12" r="10"/></svg>
                        <div class="text-xl mt-[10px]" id="contact-client-name"></div>
                      </div>
                    </div>
                    <div class="stats shadow relative h-[50px] w-[300px] h-auto">
                      <div class="stat flex gap-8">
                        <svg class="" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#e28743" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
                        <div class="text-xl mt-[10px]" id="contact-client-product"></div>
                      </div>
                    </div>
                </div>

                <div class="flex gap-60 mt-[50px]">
                  <div class="stats shadow relative h-[50px] w-[300px] left-[100px] h-auto overflow-hidden">
                    <div class="stat flex gap-8">
                      <svg class="" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#22c55e" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                      <div class="text-xl mt-[10px]" id="contact-client-contact"></div>
                    </div>
                  </div>
                  <div class="stats shadow relative  h-[50px] w-[300px] h-auto overflow-hidden">
                    <div class="stat flex gap-8">
                      <svg class="" xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 24 24" fill="none" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 9v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9"/><path d="M9 22V12h6v10M2 10.6L12 2l10 8.6"/></svg>
                      <div class="text-xl mt-[10px]" id="contact-client-address"></div>
                    </div>
                  </div>
                </div>
                  <div class="relative mt-[150px] ml-[460px]">
                    <ul class="steps absolute w-[830px]">
                      <li data-content="●" class="step step-primary">YET-TO</li>
                      <li data-content="★" class="step" id="progress-service">SERVICED</li>
                      <li data-content="✓" class="step" id="progress-delivery">DELIVERED</li>
                    </ul>
                  </div>
                  </div>
                <div id="response-message-get-info" class="mt-[265px] "></div>
            </section>

            <section id="services" class="content-section hidden">
                <h1 class="text-4xl font-bold mb-[50px]">Invoice Overview</h1>
                <div class="overflow-x-auto" style="width: 1620px; height: 600px;">
                  <table class="table table-xs">
                    <thead>
                      <tr>
                        <th>S.no</th>
                        <th>Invoice Id</th>
                        <th>Client Name</th>
                        <th>Contact</th>
                        <th>Added Date</th>
                        <th>Product Type</th>
                        <th>Product description</th>
                        <th>Damage/Problem</th>
                        <th>JobStatus</th>
                        <th>PaymentStatus</th>
                        <th>OverallStatus</th>
                        <th>Amount</th>
                      </tr>
                    </thead>
                    <tbody id="invoice-overview">
                  </table>
                </div>
            </section>

         <!-- Update Invoice Section -->
          <section id="invoice" class="content-section">
            <h1 class="text-4xl font-bold">Update Invoice</h1>
            <div class="flex flex-row gap-5 ml-20 relative">
              <p class="text-1xl font-bold top-[50px] relative">Search Client Name / InvoiceId</p>
              <input id="search-invoice" type="text" class="input input-bordered input-accent w-full max-w-xs relative top-10"/>
              <button class="btn btn-outline btn-success relative top-[38px]" onclick="fetchInvoiceDetails()">Search</button>
              <button class="btn btn-outline btn-error relative top-[38px]" onclick="clearValuesOnSearch()">Clear</button>
            </div>
            <div class="divider mt-24">Client Details</div>
            <div id="search-invoice-details" class="flex flex-row items-center gap-8 mt-8">
              <div class="flex flex-col items-start">
                <label class="text mb-5">Client Name</label>
                <input id="search-invoice-client-name" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
              <div class="flex flex-col items-start ml-[10px]">
                <label class="text mb-5">Contact</label>
                <input id="search-invoice-contact" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
              <div class="flex flex-col items-start ml-[10px]">
                <label class="text mb-5">Product Type</label>
                <select id="search-invoice-product-type" class="select select-bordered w-full">
                  <option>Laptop</option>
                  <option>Monitor</option>
                  <option>Printer</option>
                  <option>Mobile</option>
                  <option>TV</option>
                  <option>Inverter</option>
                </select>
              </div>
              <div class="flex flex-col items-start ml-20">
                <label class="text mb-5">Product description</label>
                <input id="search-invoice-product-description" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
              <div class="flex flex-col items-start ml-[10px] mr-10">
                <label class="text mb-5">Address</label>
                <input id="search-invoice-address" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
            </div>
            

            <div id="search-invoice-details" class="flex flex-row items-center gap-8 mt-8">
              <div class="flex flex-col items-start">
                <label class="text mb-5">Damage/Problem</label>
                <input id="search-invoice-damage-problem" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
              <div class="flex flex-col items-start">
                <label class="text mb-5">JobStatus</label>
                <select id="search-invoice-jobstatus" class="select select-bordered w-full">
                  <option value="YET-TO">YET-TO</option>
                  <option value="DELIVERED">DELIVERED</option>
                </select>
              </div>
              <div class="flex flex-col items-start">
                <label class="text mb-5">PaymentStatus</label>
                <select id="search-invoice-paymentstatus" class="select select-bordered w-full">
                  <option value="UNPAID">UNPAID</option>
                  <option value="PAID">PAID</option>
                </select>
              </div>
              <div class="flex flex-col items-start">
                <label class="text mb-5">OverallStatus</label>
                <select id="search-invoice-overallstatus" class="select select-bordered w-full">
                  <option value="PENDING">PENDING</option>
                  <option value="COMPLETED">COMPLETED</option>
                </select>
              </div>
              <div class="flex flex-col items-start ml-[10px]">
                <label class="text mb-5">Totall Amount(₹)</label>
                <input id="search-invoice-amount" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
              <div class="flex flex-col items-start ml-[10px]">
                <label class="text mb-5">Given Amount(₹)</label>
                <input id="search-invoice-given-amount" type="text" class="input input-bordered w-full max-w-xs"/>
              </div>
            </div>
            <button class="btn btn-outline btn-primary relative top-[100px] left-[640px]" onclick="updateInvoice()">Update Client Details</button>
            <button class="btn btn-outline btn-error relative top-[100px] left-[640px] ml-[90px]" onclick="confirmAction()">Delete Invoice</button>
            <div id="response-message" class="mt-[165px] "></div>
        </section>

        <!-- invoice-maker -->
        <section id="invoice-maker" class="content-section">
          <h1 class="text-4xl font-bold">Invoice Maker</h1>
           <div class="flex flex-row"> 
            <div class="top-[30px] left-10 relative">
              <div role="tablist" class="tabs tabs-bordered">
                <input type="radio" name="my_tabs_1" role="tab" class="tab" aria-label="Client Info" checked="checked"/>
                <div role="tabpanel" class="tab-content p-7">
                  <p class="text-1xl mb-[20px] font-bold">Client Info</p>
                    <div class="flex flex-col space-y-5">
                      <input type="text" placeholder="Invoice Id" id="bill-invoiceid" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="Date" id="bill-date" class="input input-bordered w-full max-w-xs" />
                      <select id="bill-paymenttype" class="select select-bordered w-full max-w-xsrelative">
                        <option>Cash</option>
                        <option>GooglePay</option>
                        <option>PhonePay</option>
                        <option>Card</option>
                        <option>UPI</option>
                      </select>
                      <div class="p-5"></div>
                      <input type="text" placeholder="Client Name / Company Name" id="bill-clientname" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="Address line 1" id="bill-addressline1" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="Address line 2" id="bill-addressline2" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="City" id="bill-city" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="ZIP/ pincode" id="bill-zipcode" class="input input-bordered w-full max-w-xs" />
                    </div>
                    <button class="btn btn-info mt-[20px]" onclick="AddBillInfo()">Add Info</button>
                </div>
                <input type="radio" name="my_tabs_1" role="tab" class="tab" aria-label="Add Items" />
                <div role="tabpanel" class="tab-content p-7">
                    <p class="text-1xl mb-[20px] font-bold">Add Items</p>
                    <div class="flex flex-col space-y-5">
                      <input type="text" placeholder="Item" id="bill-item" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="Description" id="bill-description" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="Quantity" id="bill-quantity" class="input input-bordered w-full max-w-xs" />
                      <input type="text" placeholder="Tax" id="bill-tax" class="input input-bordered w-full max-w-xs" value="0"/>
                      <input type="text" placeholder="Amount" id="bill-amount" class="input input-bordered w-full max-w-xs" value="0"/>
                    </div>
                    <button class="btn btn-info mt-[20px]" onclick="AddItemsToBill()">Add Item</button>
                </div>
              </div>
            </div>

            <div id="print-area" class="w-[1200px] left-[250px] top-20 relative">
              <!-- Invoice Box -->
              <div style="color: white;" id="invoice-box" class="w-2/3 bg-gray-800 p-10 rounded-lg shadow-lg">
                <!-- Header -->
                <h1 class="text-5xl font-bold text-purple-400 relative top-[40px]">Invoice</h1>
                <div class="flex flex-col justify-end items-end mb-20">
                  <p class="text-1xl font-bold text-purple-400 mb-2" id="bill-invoiceid-placeholder" >Invoice Id : -----</p>
                  <p class="text-1xl font-bold text-purple-400 mb-2" id="bill-invoicedate-placeholder">Date : ---------</p>
                </div>
                <div class="flex justify-between items-center border-b border-gray-700 pb-4">
                  <div class="flex-col ">
                    <h1 class="text-3xl font-bold text-purple-400">Dj Computer</h1>
                    <h1 class="text-2xl font-bold text-purple-400 mb-5">Sales & Service</h1>
                    <p>St. Annes Complex</p>
                    <p>Moonjikal</p>
                    <p>Kodaikanal-624101</p>
                    <p>Cell : +91 9842369490</p>
                  </div>
                  <div class="flex-col">
                    <h1 class="text-3xl font-bold text-purple-400 mb-5" id="bill-clientname-placeholder">To</h1>
                    <p id="bill-addressline1-placeholder">---------</p>
                    <p id="bill-addressline2-placeholder">---------</p>
                    <p id="bill-city-placeholder">---------</p>
                    <p class="flex justify-end items-end font-bold text-purple-400 mt-5 mr-20" style="font-size: x-small;" id="bill-paymenttype-placeholder">Payment mode : -----</p>
                  </div>
                </div>

                <!-- Invoice Table -->
                <table class="table-auto w-full mt-6 text-sm text-gray-300">
                  <thead class="bg-gray-700 text-purple-400">
                    <tr>
                      <th class="px-4 py-2 text-left">Item</th>
                      <th class="px-4 py-2 text-left">Description</th>
                      <th class="px-4 py-2 text-right">Quantity</th>
                      <th class="px-4 py-2 text-right">Tax</th>
                      <th class="px-4 py-2 text-right">Amount</th>
                    </tr>
                  </thead>
                  <tbody id="bill-elements">
                    <!-- Add more rows as needed -->
                  </tbody>
                </table>
                
                <div class="flex justify-between items-end border-b border-gray-700 pb-4"></div>
                <div class="flex flex-col justify-end items-end mb-5 mr-5 mt-5">
                  <p id="bill-totall">Totall  ________</p>
                </div>
                <div class="flex justify-between items-end border-b border-gray-700 pb-4"></div>
                <div class="flex flex-row justify-between mt-2">
                  <p style="font-size: x-small; margin-left: 10px;">E&0.E</p>
                  <p style="font-size: x-small;">GOODS ONCE SOLD WILL NOT BE RETURNED</p>
                  <p style="font-size: x-small; margin-right: 10px;">Thank you!</p>
                </div>
              </div>
              <button id="print-btn" class="btn btn-success left-[700px] mt-5 relative" onclick="printInvoice('print-area')">Print Bill</button>
            </div>
          </div>
          <div id="bill-alert" class="mt-20"></div>
        </section>
        </main>
        <!-- Footer -->
        <footer class="footer p-10 bg-base-300 text-base-content fixed top-[1340px]">
            <div>

            </div>
            <div>

            </div>
            <div>
                <span class="footer-title">Company</span>
                <a href="https://www.justdial.com/Kodaikanal/DJ-Computers-Near-Moonjikal-bus-stop/9999P4542-4542-130801103404-K3G7DC_BZDET" class="link link-hover">About us</a>
                <a href="https://www.justdial.com/Kodaikanal/DJ-Computers-Near-Moonjikal-bus-stop/9999P4542-4542-130801103404-K3G7DC_BZDET" class="link link-hover">Contact</a>
                <a hidden href="https://denni-alwin.github.io/" class="link link-hover relative left-[340px]">Designed by Denni Alwin</a>
            </div>
        </footer>
    </div>  
    
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
              function showContent(sectionId) {
              // Hide all sections
              const sections = document.querySelectorAll('.content-section');
              sections.forEach(section => section.classList.add('hidden'));

              // Show the selected section
              document.getElementById(sectionId).classList.remove('hidden');
          }

          // Show the home content by default when the page loads
          showContent('home');

          async function addInvoice() {
              // Collect data from form inputs
              const clientName = document.getElementById('client_name').value;
              const contact = document.getElementById('contact').value;
              const productType = document.getElementById('product_type').value;
              const productDescription = document.getElementById('product_description').value;
              const damageProblem = document.getElementById('damage_problem').value;
              const address = document.getElementById('address').value;
              const jobStatus = "YET-TO";
              const paymentStatus = "UNPAID";
              const overallStatus = "PENDING";
              const amount =  document.getElementById('amount').value;
              const completedDate = 0;

              // Create the payload for the API request
              const invoiceData = {
                  client_name: clientName,
                  contact: contact,
                  product_type: productType,
                  product_description: productDescription,
                  damage_problem: damageProblem,
                  address: address,
                  job_status: jobStatus,
                  payment_status: paymentStatus,
                  overall_status: overallStatus,
                  amount: amount,
                  completed_date: completedDate
              };

              try {
                  // Make the API request to add the invoice
                  const response = await fetch('/add_invoice', {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json'
                      },
                      body: JSON.stringify(invoiceData)
                  });

                  const result = await response.json();

                  // Display the result message
                  const resultDiv = document.getElementById('addResult');
                  if (response.ok) {
                      resultDiv.textContent = result.message;
                      resultDiv.style.color = 'green'; // Success message
                  } else {
                      resultDiv.textContent = result.error;
                      resultDiv.style.color = 'red'; // Error message
                  }
              } catch (error) {
                  console.error('Error adding invoice:', error);
                  const resultDiv = document.getElementById('addResult');
                  resultDiv.textContent = 'An error occurred while adding the invoice.';
                  resultDiv.style.color = 'red'; // Error message
              }
              getAllInvoices();
              fetchTotalAmount();
              fetchPendingStatus();
              fetchPendingInvoiceCount();  
              fetchPaidInvoiceCount();
              getAmountToBeCollected();
          }

          let billTotalAmount = 0;
          async function AddItemsToBill()
          {
            const item =  document.getElementById('bill-item').value;
            const description =  document.getElementById('bill-description').value;
            const quantity =  document.getElementById('bill-quantity').value;
            const tax =  document.getElementById('bill-tax').value;
            const amount =  document.getElementById('bill-amount').value;
            for (let i = 0; i < quantity; i++) 
            {
              billTotalAmount += +amount + +tax;
            }
            if(item != "" && description != "")
            {
              const row = document.createElement('tr');
              row.innerHTML = `
                      <td class="px-4 py-2">${item}</td>
                      <td class="px-4 py-2">${description}</td>
                      <td class="px-4 py-2 text-right">${quantity}</td>
                      <td class="px-4 py-2 text-right">${tax}</td>
                      <td class="px-4 py-2 text-right">${amount}₹</td>`;

              document.getElementById('bill-elements').append(row)
              document.getElementById('bill-totall').innerHTML = `Totall ${billTotalAmount} ₹`;

              document.getElementById('bill-alert').innerHTML = '<div role="alert" class="alert alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Item Added Successfully.</span></div>';
            }
            else
            {
              document.getElementById('bill-alert').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! Empty entry found</span></div>';
            }
            setTimeout(() => {document.getElementById('bill-alert').textContent = '';}, 3000);
          }

          async function AddBillInfo()
          {
            const invoiceid =  document.getElementById('bill-invoiceid').value;
            const date =  document.getElementById('bill-date').value;
            const paymentype =  document.getElementById('bill-paymenttype').value;
            const clientname =  document.getElementById('bill-clientname').value;
            const addressline1 =  document.getElementById('bill-addressline1').value;
            const addressline2 =  document.getElementById('bill-addressline2').value;
            const city =  document.getElementById('bill-city').value;
            const zipcode =  document.getElementById('bill-zipcode').value;
            if(invoiceid != "" && clientname != "" && addressline1 != "")
            {
              document.getElementById('bill-invoiceid-placeholder').innerHTML = "Invoice Id : "+invoiceid;
              document.getElementById('bill-invoicedate-placeholder').innerHTML = "Date : "+date;
              document.getElementById('bill-paymenttype-placeholder').innerHTML = "Payment mode : " +paymentype;
              document.getElementById('bill-clientname-placeholder').innerHTML = clientname;
              document.getElementById('bill-addressline1-placeholder').innerHTML = addressline1;
              document.getElementById('bill-addressline2-placeholder').innerHTML = addressline2;
              document.getElementById('bill-city-placeholder').innerHTML = city + " - " + zipcode;

              document.getElementById('bill-alert').innerHTML = '<div role="alert" class="alert alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Client Info Updated Successfully.</span></div>';
            }
            else
            {
              document.getElementById('bill-alert').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! Empty entry found</span></div>';
            }
            setTimeout(() => {document.getElementById('bill-alert').textContent = '';}, 3000);
          }

          async function getInvoice(buttonElement) {
            
            const invoiceid = buttonElement.getAttribute('data-invoice-id');
              const response = await fetch(`/get_invoice_by_id/${invoiceid}`);
              const entry = await response.json();
              const tableBody = document.getElementById('client_invoice'+invoiceid);
              tableBody.innerHTML = '';
                  const row = document.createElement('th');
                  row.innerHTML = `
                  <div id="client_invoice_details" class="overflow-x-auto">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Invoice Id</th>
                        <th>Client Name</th>
                        <th>Contact</th>
                        <th>Added Date</th>
                        <th>Product Type</th>
                        <th>Product description</th>
                        <th>Damage/Problem</th>
                        <th>JobStatus</th>
                        <th>PaymentStatus</th>
                        <th>OverallStatus</th>
                        <th>Amount</th>
                      </tr>
                    </thead>
                    <tbody>
                        <th>${entry.invoice_id}</th>
                        <th>${entry.client_name}</th>
                        <th>${entry.contact}</th>
                        <th>${entry.added_date}</th>
                        <th>${entry.product_type}</th>
                        <th>${entry.product_description}</th>
                        <th>${entry.damage_problem}</th>
                        <th><div class="badge badge-secondary badge-outline">${entry.job_status}</div></th>
                        <th><div class="badge badge-accent">${entry.payment_status}</div></th>
                        <th><div class="badge badge-error badge-outline">${entry.overall_status}</div></th>
                        <th>${entry.amount}</th>
                         </tbody>
                  </table>
                </div>
                        
                    `;
                  tableBody.appendChild(row);
          }

          async function fetchInvoiceDetails() 
          {
            let  identifier = document.getElementById('search-invoice').value;
            if (!identifier) {
              identifier = document.getElementById('search-invoice-search').value;
              document.getElementById('client-contact-details').className = '';
              if (!identifier) {
                alert('Please enter a client name or invoice ID.');
                return;
              }
            }
            clearValuesOnSearch()

            try {
                const response = await fetch(`/get_invoice_details?identifier=${identifier}`);
                const data = await response.json();

                const detailsContainer = document.getElementById('search-invoice');
              if (response.ok || data.client_name === "undefined") 
              {
                  document.getElementById('search-invoice-client-name').value = data.client_name;
                  document.getElementById('search-invoice-contact').value = data.contact;
                  document.getElementById('search-invoice-product-type').value = data.product_type;
                  document.getElementById('search-invoice-address').value = data.address;
                  document.getElementById('search-invoice-product-description').value = data.product_description;
                  document.getElementById('search-invoice-jobstatus').value = data.job_status;
                  document.getElementById('search-invoice-paymentstatus').value = data.payment_status;
                  document.getElementById('search-invoice-overallstatus').value = data.overall_status;
                  document.getElementById('search-invoice-amount').value = data.amount;
                  document.getElementById('search-invoice-damage-problem').value = data.damage_problem;
                  document.getElementById('search-invoice-given-amount').value = data.given_amount;
                  
                  const clientnameElement = document.getElementById('contact-client-name')
                  if (clientnameElement)
                  {
                    clientnameElement.textContent += "  " + data.client_name;
                    document.getElementById('contact-client-contact').textContent += "+91  " + data.contact;
                    document.getElementById('contact-client-product').textContent += "  " + data.product_description;
                    document.getElementById('contact-client-address').textContent += "  " + data.address;
                  }
                  if(data.job_status != "YET-TO")
                  {
                    document.getElementById('progress-service').classList.add('step-primary');
                  }
                  if(data.overall_status != "PENDING")
                  {
                    document.getElementById('progress-delivery').classList.add('step-primary');
                  }
                } 
                else 
                {
                    document.getElementById('response-message').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! Invoice not Available</span></div>';
                    document.getElementById('response-message-get-info').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! Invoice not Available</span></div>';
                    console.error('Error:', error);
                }
            } catch (error) 
            {
                document.getElementById('response-message').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! Invoice not Available</span></div>';
                document.getElementById('response-message-get-info').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! Invoice not Available</span></div>';
                console.error('Error:', error);
            }
            setTimeout(() => {document.getElementById('response-message').textContent = '';}, 3000);
            setTimeout(() => {document.getElementById('response-message-get-info').textContent = '';}, 3000);
        }

        async function updateInvoice() 
        {
            const identifier = document.getElementById('search-invoice').value;
            const clientName = document.getElementById('search-invoice-client-name').value;
            const contact = document.getElementById('search-invoice-contact').value;
            const productType = document.getElementById('search-invoice-product-type').value;
            const productDescription = document.getElementById('search-invoice-product-description').value;
            const address = document.getElementById('search-invoice-address').value;
            const jobStatus = document.getElementById('search-invoice-jobstatus').value;
            const paymentStatus = document.getElementById('search-invoice-paymentstatus').value;
            const overallStatus = document.getElementById('search-invoice-overallstatus').value;
            const amount = document.getElementById('search-invoice-amount').value;
            const damageProblem = document.getElementById('search-invoice-damage-problem').value;
            const givenAmount = document.getElementById('search-invoice-given-amount').value;

            const updateFields = {};

            if (clientName) updateFields.client_name = clientName;
            if (contact) updateFields.contact = contact;
            if (productType) updateFields.product_type = productType;
            if (productDescription) updateFields.product_description = productDescription;
            if (address) updateFields.address = address;
            if (jobStatus) updateFields.job_status = jobStatus;
            if (paymentStatus) updateFields.payment_status = paymentStatus;
            if (overallStatus) updateFields.overall_status = overallStatus;
            if (amount) updateFields.amount = parseFloat(amount);
            if (damageProblem) updateFields.damage_problem = damageProblem;
            if (givenAmount) updateFields.given_amount = givenAmount;

            try {
                const response = await fetch('/update_invoice', {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    
                    body: JSON.stringify({ identifier, update_fields: updateFields }),
                });
                const result = await response.json();
                document.getElementById('response-message').innerHTML = '<div role="alert" class="alert alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Invoice Updated Successfully.</span></div>';
            } catch (error) {
                document.getElementById('response-message').innerHTML = '<div role="alert" class="alert alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 shrink-0 stroke-current" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span>Error! updating invoice. Please try again.</span></div>';
                console.error('Error:', error);
            }
            setTimeout(() => {document.getElementById('response-message').textContent = '';}, 5000);
            clearValuesOnSearch();
            document.getElementById('search-invoice').value = "";
        }

        async function clearValuesOnSearch() 
        {
          document.getElementById('search-invoice-client-name').value = "";
          document.getElementById('search-invoice-contact').value = "";
          document.getElementById('search-invoice-product-type').value = "";
          document.getElementById('search-invoice-product-description').value = "";
          document.getElementById('search-invoice-jobstatus').value = "";
          document.getElementById('search-invoice-paymentstatus').value = "";
          document.getElementById('search-invoice-overallstatus').value = "";
          document.getElementById('search-invoice-amount').value = "";
          document.getElementById('search-invoice-address').value = "";
          document.getElementById('search-invoice-damage-problem').value = "";
          document.getElementById('search-invoice-given-amount').value = "";
          document.getElementById('search-invoice-search').value = "";
          //document.getElementById('search-invoice').value = "";
          if(document.getElementById('contact-client-contact') != null)
          {
            document.getElementById('contact-client-contact').textContent = "";
            document.getElementById('contact-client-address').textContent = "";
            document.getElementById('contact-client-name').textContent = "";
            document.getElementById('contact-client-product').textContent = "";
          }
          document.getElementById('progress-service').classList.remove('step-primary');
          document.getElementById('progress-delivery').classList.remove('step-primary');

          document.getElementById('bill-invoiceid').value = "";
          document.getElementById('bill-date').value = "";
          document.getElementById('bill-clientname').value = "";
          document.getElementById('bill-addressline1').value = "";
          document.getElementById('bill-addressline2').value = "";
          document.getElementById('bill-city').value = "";
          document.getElementById('bill-zipcode').value = "";

          document.getElementById('bill-item').value = "";
          document.getElementById('bill-description').value = "" ;
          document.getElementById('bill-quantity').value = "";
          document.getElementById('bill-tax').value = "";
          document.getElementById('bill-amount').value = "";
        }

          async function fetchPendingStatus() 
          {
            try {
                const response = await fetch('/get_pending_status');
                const pendingEntries = await response.json();
              const tableBody = document.getElementById('data-table-body');
              tableBody.innerHTML = '';  // Clear existing table rows
              
              pendingEntries.forEach(entry => {
                  const row = document.createElement('tr');
                  row.innerHTML = `    
                      <tr>
                        <td>
                          <div class="flex items-center gap-3">
                            </div>
                            <div>
                              <div class="font-bold">${entry.client_name}</div>
                            </div>
                          </div>
                        </td>
                        <td>
                          ${entry.product_description}
                        </td>
                        <td>${entry.product_type}</td>
                        <td>
                          <div class="badge badge-secondary badge-outline">${entry.job_status}</div>
                        </td>
                        <td>
                          <div class="badge badge-accent badge-accent">${entry.payment_status}</div>
                        </td>
                        <td>
                          <div class="badge badge-success badge-success">₹${entry.given_amount}</div>
                        </td>
                        <th>
                          <button id="details" data-invoice-id="${entry.invoice_id}" class="btn" onclick="my_modal_4${entry.invoice_id}.showModal(); getInvoice(this)">Details</button>
                          <dialog id="my_modal_4${entry.invoice_id}" class="modal">
                            <div class="modal-box w-11/12 max-w-[1420px] h-[190px]">
                              <form method="dialog">
                                <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2" onclick="document.getElementById('client_invoice_details').remove()">✕</button>
                              </form>
                              <h3 id="client_invoice${entry.invoice_id}" class="text-lg font-bold"></h3>
                            </div>
                          </dialog>
                        </th>
                      </tr>
                  `;
                  tableBody.appendChild(row);
                });

               
            } catch (error) {
                console.error('Error fetching pending status:', error);
            }
        }

          async function getAllInvoices() {
              const response = await fetch('/get_all_invoices');
              const result = await response.json();

              const invoicetableBody = document.getElementById('invoice-overview');
              let count = 1;
              invoicetableBody.innerHTML = '';
              result.forEach(entry => {
                  const invoicerow = document.createElement('tr');
                  invoicerow.innerHTML = ` 
                        <th>${count}</th>
                        <th>${entry.invoice_id}</th>
                        <th>${entry.client_name}</th>
                        <th>${entry.contact}</th>
                        <th>${entry.added_date}</th>
                        <th>${entry.product_type}</th>
                        <th>${entry.product_description}</th>
                        <th>${entry.damage_problem}</th>
                        <th><div class="badge badge-secondary badge-outline">${entry.job_status}</div></th>
                        <th><div class="badge badge-accent">${entry.payment_status}</div></th>
                        <th><div class="badge badge-error badge-outline">${entry.overall_status}</div></th>
                        <th>${entry.amount}</th>
                    `;
                 
                invoicetableBody.appendChild(invoicerow);
                count++
                  
              });
          }

          async function deleteInvoice() {
              const clientName = document.getElementById('search-invoice').value;
              const response = await fetch(`/delete_invoice/${clientName}`, { method: 'DELETE' });
              const result = await response.json();
              document.getElementById('deleteResult').innerText = JSON.stringify(result);
          }

         async function confirmAction() {
            // Show confirmation dialog
            const userConfirmed = confirm("Are you sure you want to proceed?");
            if (userConfirmed) {
                // User clicked "OK"
                deleteInvoice();
                alert("Invoice Delete Successfully!");
                // Place the action you want to perform here
                // For example, delete an item or submit a form
            } else {
                // User clicked "Cancel"
                alert("Action canceled!");
            }
        }
          async function fetchTotalAmount() {
            try {
                const response = await fetch('/get_total_amount');
                const data = await response.json();
                const totalAmountElement = document.getElementById('total-amount');
                totalAmountElement.textContent = `₹${data.total_amount}`; // Display the amount in the HTML
            } catch (error) {
                console.error('Error fetching the total amount:', error);
                document.getElementById('total-amount').textContent = 'Error';
            }
        }

        async function getAmountToBeCollected() {
            try {
                const response = await fetch('/get_amount_to_be_collected');
                const data = await response.json();
                const totalAmountElement = document.getElementById('total-amount-collection');
                totalAmountElement.textContent = `₹${data.amount_to_be_collected}`; // Display the amount in the HTML
            } catch (error) {
                console.error('Error fetching the total amount:', error);
                document.getElementById('total-amount-collection').textContent = 'Error';
            }
        }

        async function fetchPendingInvoiceCount() {
          try {
              const response = await fetch('/get_pending_invoice_count');
              const result = await response.json();
              const pendingCountElement = document.getElementById('pending-invoice-count');
              pendingCountElement.textContent = result.pending_invoice_count;
          } catch (error) {
              console.error('Error fetching pending invoice count:', error);
          }
          }

          // Function to fetch and display the count of paid invoices
          async function fetchPaidInvoiceCount() {
              try {
                  const response = await fetch('/get_paid_invoice_count');
                  const result = await response.json();
                  const paidCountElement = document.getElementById('paid-invoice-count');
                  paidCountElement.textContent = result.paid_invoice_count;
              } catch (error) {
                  console.error('Error fetching paid invoice count:', error);
              }
          }
          async function printInvoice(divId) 
          {
            const printContents = document.getElementById(divId).innerHTML;
            const originalContents = document.body.innerHTML;
            const originalClasses = document.body.className; // Store the original classes
            document.body.className = '';
            
            document.body.innerHTML = printContents;
            document.getElementById("print-btn").remove();
            document.body.style.justifyContent = "center";
            document.body.style.marginTop = "50px";
            document.body.style.width = "1600px";
            document.getElementById("invoice-box").style.color = "black";
            document.getElementById("bill-elements").style.color = "black";
            document.getElementById("invoice-box").style.backgroundColor = "white";
            window.print();
            //document.body.innerHTML = originalContents;
            location.reload();
          }

          window.onload = function() {
              getAllInvoices();
              fetchTotalAmount();
              fetchPendingStatus();
              fetchPendingInvoiceCount();  
              fetchPaidInvoiceCount();
              getAmountToBeCollected();
          };
    </script>
        <style>
          body {
              transform: scale(0.9); /* Scale down to 90% */
              transform-origin: top left; /* Keep scaling from the top left corner */
              width: 111.11%; /* Adjust width to maintain layout */
              overflow-x: hidden; /* Prevent horizontal scroll */
          }
      </style>
  
</body>
</html>
